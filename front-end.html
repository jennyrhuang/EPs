<!--PROGRAMAÇÃO ORIENTADA A OBJETOS - Trabalho final
 Autor: Jennifer Ruei Huang
 Data: 14/02/2022

Desenvolva um sistema simples para web com camada no cliente (HTML5) e camada no servidor.-->


<!DOCTYPE html>
<html>
    <head>
        <title>Cadastro</title>
        <meta charset="UTF-8">
        <meta author="Jennifer Ruei-Huang">
        
        <meta name="viewport" content="wwidth=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://www.w3schools.com/w3schools.com/w3css/4/w3.css">
        
        <!-- JQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
        <script src='back-end.js'></script>
        
        <script>
           $(document).ready(function(){
           $("#iconfirma").blur(function(){
               if( this.value == $('#isenha').value) {
                   alert("Senha incorreta")
               }
               
           }  
           }
            
            
            
            function checasenha(ev) { 
                inpsenhaconf = evento.currentTarget
                inpsenha = document.getElementById("isenha")
                
                if( inpsenha.value != inpsenhaconf.value ) {
                    ls = document.getElementById("lsenha")
                    lc = document.getElementById("lconfirma")
                    
                    ls.className = "w3-text-red"
                    lc.className = "w3-text-red" 
                    
                    //ls.style = {'color': 'red'}
                    //lc.style = {'color': 'red'}
                    
                    inpsenhaconf.value = ""
                    inpsenha.value = ""

                    //alert("Confira a senha novamente.")
                    document.getElementById("caixaerro").style.display='block'
                    document.getElementById("mensagemerro").innerHTML = "Verifique sua senha"
                    inpsenha.focus()
                }
                
                else {
                    ls.className = "w3-text-black"
                    lc.className = "w3-text-black"
                    ls.innerHTML = "Senha OK"
                    lc.innerHTML = "Senha OK"
                    //inpsenhaconf.disabled = true
                    //inpsenha.disabled = true
                    inpsenhaconf.className = "w3-hide"
                    lc.hidden = true
                    inpsenha.className = "w3-hide"
                }
            }
        </script>
        
        
    <script>
function testaCPF(evento) {
    var Soma;
    var Resto;
    Soma = 0;
    
    strCPF = evento.currentTarget.value
    strCPF = strCPF.replace('.','')
    strCPF = strCPF.replace('.','')
    strCPF = strCPF.replace('-','')
    
    if (strCPF == "00000000000") corrigeCPF(strCPF);

  for (i=1; i<=9; i++) Soma = Soma + parseInt(strCPF.substring(i-1, i)) * (11 - i);
  Resto = (Soma * 10) % 11;

    if ((Resto == 10) || (Resto == 11))  Resto = 0;
    if (Resto != parseInt(strCPF.substring(9, 10)) ) corrigeCPF(strCPF);

  Soma = 0;
    for (i = 1; i <= 10; i++) Soma = Soma + parseInt(strCPF.substring(i-1, i)) * (12 - i);
    Resto = (Soma * 10) % 11;

    if ((Resto == 10) || (Resto == 11))  Resto = 0;
    if (Resto != parseInt(strCPF.substring(10, 11) ) ) corrigeCPF(strCPF);
    return true;
}
    function corrigeCPF(cpf) {
         document.getElementById("caixaerro").style.display='block'
                    document.getElementById("mensagemerro").innerHTML = "CPF invalido: "+cpf
        
        inputCPF = document.getElementById("icpf")
        inputCPF.value=""
        inputCPF.className = "w3-text-red"
    }
        
    function pegaDadosCep(evento) {
        const xhttp = new XMLHttpRequest()
        xhttp.onload = dadosCepCarregados
        
        cpoCep = evento.currentTarget
        // cpoCep.value
        
        url = "https://viacep.com.br/ws/" + cpoCep.value + "/json"
        xhttp.open("GET", url);
        xhttp.send();
    }
        
    function dadosCepCarregados() {
        resp = JSON.parse(this.responseText)
        cpoLogr = document.getElementById("ilogradouro")
        cpoLogr.value = resp.logradouro
        cpoLogr.disabled = true
        document.getElementById("inum").focus()
    }
        

    </script>
        
        
    </head>
    
    <body>
        
    <div class="w3-container">
        <h2>Entrada de dados</h2>
        
        <div class="w3-card-4">
            <div class="w3-container w3-green">
                <h2>Cadastro</h2>
            </div>
        
    <form action="http://bioinfo.unifesp.br" method="post" class="w3-container">
        <p>
            <label>Nome:</label>
            <input type="text" id="inome" name="nome" class="w3-input w3-border"></input>
        </p>
        <p>
            <label>E-mail:</label>
            <input type="text" id="imail" name="mail" class="w3-input"></input>
        </p>
        <p>
            <label>CPF:</label>
            <input type="text" id="icpf" name="cpf" class="w3-input" onblur="testaCPF()"></input>
        </p>
        <p>
            <label id="lsenha">Senha:</label>
            <input type="password" id="isenha" name="senha" class="w3-input"></input>
        </p>
        <label id="lconfirma">Confirma senha:</label>
            <input type="password" id="iconfirma" name="senha" class="w3-input" onblur="checasenha(event)"></input>
        </p>
        <p>
            <label>CEP:</label>
            <input type="text" id="icep" name="cep" class="w3-input" onblur="pegaDadosCep(event)"></input>
        <p>
            <div class="w3-twothird">
            <label>Endereco</label>
            <input type="text" id="ilogradouro" name="logradouro" class="w3-input"></input>
            </div>
            <div class="w3-third">
            <label>Numero:</label>
            <input type="text" id="inum" name="numero" class="w3-input" size="6"></input>
        </p>

        

        <p class="w3-container w3-margin">
            <button type="submit" class="w3-btn w3-green w3-center w3-round">OK</button>
        </p>


<!-- caixa de dialogo modal -->
    <div id="caixaerro" class="w3-modal">
    <div class="w3-modal-content w3-card-4">
      <header class="w3-container w3-teal"> 
        <span onclick="document.getElementById('errosenha').style.display='none'" 
        class="w3-button w3-display-topright">&times;</span>
        <h2>Atencao</h2>
      </header>
      <div class="w3-container">
        <p id="mensagemerro">XXXXXXX</p>
      </div>
        <button class="w3-btn w3-green" onclick="document.getElementById('errosenha').style.display='none'" 
    </div>
  </div>

            
    </form>
        
        
    <p id=textop class="w3-container w3-blue w3-padding-large" onmouseover="this.style='color:red'" onmouseout="this.style='color:blue'">
        Elemento (textop): Alo mundo! Aponte aqui.
        </p>
        
    <p id="mostraInputNome" class="w3-container w3-button w3-blue w3-border w3-hide" onclick="mostraInputNome(this)">
        Clique aqui para mudar o nome
        </p>
        
    <span id="entradaNome" class="w3-container"> Entre com seu nome:
        <input id="entra" name="val" onblur="alteraCumprimento(this)">
        </span>
        
    
        
</div>
</div>    
    </body> 
        
</html> 
        